---
import Main from '../../../layouts/main.astro';
const { tag } = Astro.params;
const postImports = import.meta.glob('../../../content/blog/*.mdx', { eager: true });
let posts = Object.values(postImports);
posts = posts.filter(p => (p.frontmatter.tags || []).includes(tag));
posts.sort((a, b) => (b.frontmatter.pubDate?.valueOf() ?? 0) - (a.frontmatter.pubDate?.valueOf() ?? 0));
const title = `Posts tagged ${tag}`;
const description = `Articles related to ${tag}.`;
---
<Main title={title}>
  <section class="max-w-3xl mx-auto py-8 space-y-4">
    <h1 class="text-3xl font-bold">{title}</h1>
    <p class="text-gray-600">{description}</p>
    <ul class="space-y-6">
      {posts.map(post => (
        <li>
          <a href={post.url} class="text-xl text-blue-600 hover:underline font-semibold">
            {post.frontmatter.title}
          </a>
          {post.frontmatter.description && (
            <p class="text-gray-600">{post.frontmatter.description}</p>
          )}
          {post.frontmatter.pubDate && (
            <p class="text-sm text-gray-500 mt-1">{new Date(post.frontmatter.pubDate).toLocaleDateString()}</p>
          )}
        </li>
      ))}
    </ul>
  </section>
</Main>
