---
import DashboardLayout from '../components/DashboardLayout.astro';
---
<DashboardLayout>
  <section class="container py-5 text-center">
    <h1>Dashboard</h1>
    <p id="user-email" class="mb-4"></p>
    <button id="logout" class="btn btn-outline-light">Logout</button>
  </section>
  <script type="module">
    document.addEventListener('DOMContentLoaded', () => {
      const emailEl = document.getElementById('user-email');
      const logoutBtn = document.getElementById('logout');
      if (window.firebaseAuth) {
        window.onAuthStateChanged(window.firebaseAuth, user => {
          if (!user) {
            window.location.href = '/login';
          } else {
            emailEl.textContent = user.email;
          }
        });
        logoutBtn.addEventListener('click', async () => {
          window.loggingOut = true;
          await window.authSignOut();
          window.location.href = '/';
        });
      }
    });
  </script>
</DashboardLayout>
